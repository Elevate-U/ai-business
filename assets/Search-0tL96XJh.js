import{A as w,u as e,L}from"./index-8EZUBNgj.js";import{d as o,y as P}from"./react-vendor-BYlzYzcd.js";import{M as U}from"./MovieCard-D2dB4wDk.js";/* empty css             *//* empty css                  */const j=p=>{const[d,c]=o([]),[A,m]=o(!1),[n,g]=o(""),[l,v]=o("all"),[y,b]=o({anilist:!1,tmdb:!1});P(()=>{const a=new URLSearchParams(p.url?.split("?")[1]||""),s=a.get("q"),i=a.get("filter")||"all";g(s||""),v(i),s?u(s,i):c([])},[p.url]);const u=async(a,s="all")=>{m(!0);try{const i=`${w}/search/unified?query=${encodeURIComponent(a)}&type=${s}`,N=await fetch(i);if(N.ok){const r=await N.json();b({anilist:r.anilist&&Array.isArray(r.anilist)&&r.anilist.length>0,tmdb:r.tmdb&&(r.tmdb.movies&&Array.isArray(r.tmdb.movies)&&r.tmdb.movies.length>0||r.tmdb.tv&&Array.isArray(r.tmdb.tv)&&r.tmdb.tv.length>0)}),r.combined&&Array.isArray(r.combined)?c(r.combined):(console.warn("Combined data is missing or not an array"),c([])),m(!1);return}console.log("Falling back to TMDB search API");const f=await(await fetch(`${w}/tmdb/search/multi?query=${encodeURIComponent(a)}`)).json();if(f&&f.results){let r=f.results;s!=="all"&&(r=r.filter(t=>t.media_type===s));const C=r.filter(t=>(t.media_type==="movie"||t.media_type==="tv")&&(t.poster_path||t.backdrop_path)).filter((t,_,q)=>_===q.findIndex(S=>S.id===t.id&&S.media_type===t.media_type));c(C),b({anilist:!1,tmdb:!0})}}catch(i){console.error("Error performing search:",i),c([])}finally{m(!1)}},h=a=>{v(a),u(n,a);const s=new URL(window.location);s.searchParams.set("q",n),s.searchParams.set("filter",a),window.history.pushState({},"",s.toString())},R=a=>{const s=a.target.value;g(s),s.trim()===""&&c([]);const i=new URL(window.location);i.searchParams.set("q",s),i.searchParams.set("filter",l),window.history.replaceState({},"",i.toString())},$=(a,s)=>e("div",{className:"movie-card-container",children:[e(U,{item:a,type:a.media_type||(a.episodes?"anime":"movie"),progress:null,duration:null}),a.source&&e("div",{className:`source-badge source-${a.source}`,children:a.source==="anilist"?"AL":"TMDB"})]},`${a.media_type||"item"}-${a.id}-${s}`);return e("div",{className:"container home-page",children:[e("div",{className:"search-header",children:[e("form",{onSubmit:a=>{a.preventDefault(),n.trim()&&u(n.trim(),l)},className:"search-form-container",children:[e("input",{type:"text",value:n,onInput:R,placeholder:"Search for movies, TV shows, or anime...",className:"search-input-field",autofocus:!0}),e("button",{type:"submit",className:"search-submit-button",children:"Search"})]}),e("h1",{className:"main-title",children:"Search Results"}),e("div",{className:"search-query-display",children:[e("span",{className:"search-label",children:"Showing results for:"}),e("span",{className:"search-query",children:['"',n,'"']})]}),e("div",{className:"search-sources",children:[y.anilist&&e("span",{className:"data-source anilist",children:"AniList"}),y.tmdb&&e("span",{className:"data-source tmdb",children:"TMDB"})]}),e("div",{className:"search-filters",children:[e("button",{className:`filter-btn ${l==="all"?"active":""}`,onClick:()=>h("all"),children:"All"}),e("button",{className:`filter-btn ${l==="movie"?"active":""}`,onClick:()=>h("movie"),children:"Movies"}),e("button",{className:`filter-btn ${l==="tv"?"active":""}`,onClick:()=>h("tv"),children:"TV Shows"}),e("button",{className:`filter-btn ${l==="anime"?"active":""}`,onClick:()=>h("anime"),children:"Anime"})]})]}),A?e(L,{text:"Searching across multiple sources..."}):d.length>0?e("section",{className:"home-section",children:[e("h2",{children:["Found ",d.length," result",d.length!==1?"s":""]}),e("div",{className:"movie-grid",children:d.map($)})]}):n?e("div",{className:"no-results",children:[e("div",{className:"no-results-icon",children:"üîç"}),e("h3",{children:"No results found"}),e("p",{children:[`We couldn't find anything for "`,n,'" in the ',l==="all"?"database":l," category."]}),e("div",{className:"search-suggestions",children:[e("p",{children:"Try:"}),e("ul",{children:[e("li",{children:"Using different keywords or spelling"}),e("li",{children:"Searching in a different category"}),e("li",{children:"Using the title in its original language"}),e("li",{children:"Searching for something more general"})]})]})]}):e("div",{className:"search-welcome",children:[e("div",{className:"search-welcome-icon",children:"üé¨"}),e("h3",{children:"Start your search"}),e("p",{children:"Search across multiple sources including TMDB and AniList."})]})]})};export{j as default};
//# sourceMappingURL=Search-0tL96XJh.js.map
