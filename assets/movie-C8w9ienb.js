import{O as T,A as y,u as e,b as J,o as Y,I as B,j as K}from"./index-B_gc-6eg.js";import{E as Q,d as g,y as X}from"./react-vendor-BYlzYzcd.js";import{r as Z,a as ee}from"./favorites-CubjwWEv.js";import{M as te}from"./MovieCard-BWxubO6M.js";/* empty css                  */async function L(n){try{const t=await fetch(n);if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}catch(t){return console.error("Fetch error:",t),null}}function R(n,t){const a=t==="movie",r=a?n.title:n.name;a?n.release_date:n.first_air_date;const i=n.media_type||t,d=document.createElement("div");return d.className="movie-card",d.innerHTML=`
        <a href="movie.html?id=${n.id}&type=${i}">
            <img src="${y}${n.poster_path}" alt="${r}" loading="lazy">
            <div class="movie-card-info">
                <h3>${r}</h3>
                <p>⭐ ${n.vote_average.toFixed(1)}</p>
            </div>
        </a>
    `,d.innerHTML}function U(){const n=document.getElementById("search-input"),t=document.getElementById("search-button"),a=()=>{const r=n.value.trim();r&&(window.location.href=`search.html?q=${encodeURIComponent(r)}`)};t&&t.addEventListener("click",a),n&&n.addEventListener("keypress",r=>{r.key==="Enter"&&a()})}document.addEventListener("DOMContentLoaded",()=>{({currentMediaType:"movie",heroSlideshowInterval:null,elements:{heroSection:document.getElementById("hero"),contentDisplay:document.getElementById("content-display"),genreResultsSection:document.getElementById("genre-results"),navLinks:document.querySelectorAll("header nav a[data-type]"),genreBar:document.getElementById("genre-bar"),trendingMoviesGrid:document.querySelector("#trending-movies .movie-grid"),topRatedMoviesGrid:document.querySelector("#top-rated-movies .movie-grid"),trendingTvGrid:document.querySelector("#trending-tv .movie-grid"),topRatedTvGrid:document.querySelector("#top-rated-tv .movie-grid"),genreResultsGrid:document.getElementById("genre-results-grid"),genreResultsTitle:document.getElementById("genre-results-title"),paginationContainer:document.getElementById("pagination"),continueWatchingSection:document.getElementById("continue-watching")},init(){this.displayContinueWatching(),this.setupEventListeners(),this.switchView(this.currentMediaType),this.elements.navLinks[0].classList.add("active"),U()},setupEventListeners(){this.elements.navLinks.forEach(t=>{t.addEventListener("click",a=>{a.preventDefault(),this.switchView(t.dataset.type)})})},switchView(t){this.currentMediaType=t,this.elements.navLinks.forEach(a=>{a.classList.toggle("active",a.dataset.type===t)}),this.elements.contentDisplay.classList.remove("hidden"),this.elements.genreResultsSection.classList.add("hidden"),this.fetchAndDisplaySections(t),this.fetchAndDisplayGenres(t)},async fetchAndDisplaySections(t){this.toggleSectionVisibility(t);const a=t==="movie"?this.elements.trendingMoviesGrid:this.elements.trendingTvGrid,r=t==="movie"?this.elements.topRatedMoviesGrid:this.elements.topRatedTvGrid;a.innerHTML="<p>Loading...</p>",r.innerHTML="<p>Loading...</p>";const i=`${y}/trending/${t}/week`,d=`${y}/${t}/top_rated?language=en-US&page=1`,[l,f]=await Promise.all([L(i),L(d)]);l&&l.results&&(this.displayGrid(l.results,a,t),this.startHeroSlideshow(l.results.slice(0,5),t)),f&&f.results&&this.displayGrid(f.results,r,t)},displayGrid(t,a,r){if(!t||t.length===0){a.innerHTML="<p>No items to display.</p>";return}a.innerHTML=t.map(i=>R(i,r)).join(""),attachFavoriteListeners()},toggleSectionVisibility(t){const a=t==="movie";document.getElementById("trending-movies").style.display=a?"block":"none",document.getElementById("top-rated-movies").style.display=a?"block":"none",document.getElementById("trending-tv").style.display=a?"none":"block",document.getElementById("top-rated-tv").style.display=a?"none":"block"},updateHeroContent(t,a){this.elements.heroSection.style.backgroundImage=`linear-gradient(to right, rgba(0, 0, 0, 0.7) 30%, transparent), url(${T}${t.backdrop_path})`;const r=a==="movie"?t.title:t.name,i=`movie.html?id=${t.id}&type=${a}`;this.elements.heroSection.innerHTML=`
                <div class="hero-content">
                    <h1 class="hero-title">${r}</h1>
                    <p class="hero-overview">${t.overview}</p>
                    <a href="${i}" class="btn btn-primary">▶ Watch Now</a>
                </div>
            `},startHeroSlideshow(t,a){if(!t||t.length===0)return;let r=0;this.updateHeroContent(t[r],a),clearInterval(this.heroSlideshowInterval),this.heroSlideshowInterval=setInterval(()=>{r=(r+1)%t.length,this.updateHeroContent(t[r],a)},7e3)},async fetchAndDisplayGenres(t){const a=`${y}/genre/${t}/list?language=en-US`,r=await L(a);!r||!r.genres||(this.elements.genreBar.innerHTML='<button class="genre-btn active" data-genre-id="all">All Genres</button>'+r.genres.map(i=>`<button class="genre-btn" data-genre-id="${i.id}">${i.name}</button>`).join(""),this.elements.genreBar.querySelectorAll(".genre-btn").forEach(i=>{i.addEventListener("click",()=>{this.elements.genreBar.querySelector(".genre-btn.active").classList.remove("active"),i.classList.add("active");const d=i.dataset.genreId,l=i.textContent;d==="all"?(this.elements.contentDisplay.classList.remove("hidden"),this.elements.genreResultsSection.classList.add("hidden")):this.fetchAndDisplayByGenre(t,d,l)})}))},async fetchAndDisplayByGenre(t,a,r,i=1){const d=`${y}/discover/${t}?with_genres=${a}&language=en-US&page=${i}`,l=await L(d);l&&(this.elements.contentDisplay.classList.add("hidden"),this.elements.genreResultsSection.classList.remove("hidden"),this.elements.genreResultsTitle.textContent=`${r}`,this.displayGrid(l.results,this.elements.genreResultsGrid,t),this.setupPagination(t,a,r,i,l.total_pages))},setupPagination(t,a,r,i,d){if(this.elements.paginationContainer.innerHTML="",d<=1)return;const l=(p,m,u=!1)=>{const _=document.createElement("button");return _.textContent=m,_.disabled=u,u||_.addEventListener("click",()=>this.fetchAndDisplayByGenre(t,a,r,p)),_};i>1&&this.elements.paginationContainer.appendChild(l(i-1,"« Prev"));const f=Math.max(1,i-2),c=Math.min(d,i+2);for(let p=f;p<=c;p++){const m=l(p,p);p===i&&(m.classList.add("active"),m.disabled=!0),this.elements.paginationContainer.appendChild(m)}i<d&&this.elements.paginationContainer.appendChild(l(i+1,"Next »"))},displayContinueWatching(){const t=getHistory();if(!t||t.length===0){this.elements.continueWatchingSection.classList.add("hidden");return}this.elements.continueWatchingSection.classList.remove("hidden");let r=t.slice(0,10).map(i=>{const d=R(i,i.type),l=document.createElement("div");l.innerHTML=d;const f=l.querySelector(".movie-info");let c=0;if(i.type==="movie"&&i.progress)c=i.progress;else if(i.type==="tv"&&i.watchedEpisodes){const p=Object.keys(i.watchedEpisodes).length,m=Object.values(i.watchedEpisodes).filter(u=>u.status==="completed").length;p>0&&(c=m/p*100)}return f&&c>0&&(f.innerHTML+=`<div class="progress-bar-container"><div class="progress-bar" style="width: ${c}%;"></div></div>`),l.innerHTML}).join("");this.elements.continueWatchingSection.innerHTML=`
                <h2>Continue Watching</h2>
                <div class="movie-grid">${r}</div>
            `,attachFavoriteListeners()}}).init()});const ne=()=>{const[n,t]=g(null),[a,r]=g([]),[i,d]=g([]),[l,f]=g(null),[c,p]=g(null),{isShowFavorited:m}=J(),[u,_]=g(null),[se,W]=g(null),[x,P]=g(!0),[D,q]=g(!1),[G,H]=g(1),[k,M]=g(1);X(()=>{const s=window.location.pathname.split("/"),o=s[1],h=s[2];f(h),p(o);const $=Y().find(S=>S.id==h);$&&W($),h&&o&&F(h,o),U()},[l]);const F=async(s,o)=>{P(!0);const h=`${y}/tmdb/${o}/${s}?language=en-US`,$=`${y}/tmdb/${o}/${s}/videos?language=en-US`,S=`${y}/tmdb/${o}/${s}/recommendations?language=en-US`;try{const[b,E,w]=await Promise.all([L(h,"Error loading media details"),L($,"Error loading videos"),L(S,"Error loading recommendations")]);if(t(b),r(E?.results||[]),d(w?.results||[]),o==="tv"&&b&&b.seasons){const C=await A(s,b.seasons[0].season_number);_(C)}}catch(b){console.error("Failed to fetch page data",b)}finally{P(!1)}},A=async(s,o)=>{const h=`${y}/tmdb/tv/${s}/season/${o}?language=en-US`;return await L(h)},j=async s=>{const o=await A(l,s);_(o),H(1),M(1)},N=()=>{const s={id:n.id,type:c,title:n.name||n.title,poster_path:n.poster_path,vote_average:n.vote_average};m(n.id,c)?Z(s):ee(s)},I=(s,o=null,h=null,$=!1)=>{const S=document.getElementById("video-player");if(!S)return;const b={id:n.id,type:c,title:n.name||n.title,poster_path:n.poster_path,vote_average:n.vote_average};K(b,o,h);let E="";c==="movie"?E=`${y}/stream-url?source=${s}&type=movie&id=${l}`:c==="tv"&&(E=`${y}/stream-url?source=${s}&type=tv&id=${l}&season=${o}&episode=${h}&dub=${$}`),fetch(E).then(w=>w.json()).then(w=>{w.url&&(S.src=w.url)})},V=()=>{const s=a.find(o=>o.type==="Trailer"&&o.site==="YouTube");return s?e("div",{id:"trailer-modal",class:"modal",children:e("div",{class:"modal-content",children:[e("span",{class:"close-button",onClick:()=>document.getElementById("trailer-modal").style.display="none",children:"×"}),e("iframe",{width:"560",height:"315",src:`https://www.youtube.com/embed/${s.key}`,frameborder:"0",allow:"accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; fullscreen; picture-in-picture",allowfullscreen:!0})]})}):null};if(x)return e("div",{class:"loading-spinner"});if(!n)return e("p",{class:"container",children:"Could not load media details. Please try again later."});const O=n.backdrop_path?`${T}${n.backdrop_path}`:"";return e("div",{children:[e("div",{id:"backdrop",style:{backgroundImage:`url(${O})`}}),e("main",{class:"container",id:"media-details-content",children:[e("section",{id:"media-header",children:[e("div",{class:"poster",children:e("img",{src:`${B}${n.poster_path}`,alt:n.title||n.name})}),e("div",{class:"info",children:[e("div",{class:"title-container",children:[e("h1",{children:n.title||n.name}),e("button",{id:"favorite-btn",class:m(n.id,c)?"favorited":"",onClick:N,children:m(n.id,c)?"♥ Favorited":"♡ Add to Favorites"})]}),e("div",{class:"meta",children:[e("span",{children:n.release_date||n.first_air_date}),e("span",{children:n.genres.map(s=>s.name).join(", ")}),n.runtime&&e("span",{children:[n.runtime," min"]}),e("span",{class:"rating",children:["★ ",n.vote_average.toFixed(1)]})]}),e("p",{class:"overview",children:n.overview}),e("div",{class:"actions",children:a.find(s=>s.type==="Trailer")&&e("button",{id:"watch-trailer-btn",onClick:()=>document.getElementById("trailer-modal").style.display="block",children:"Watch Trailer"})})]})]}),e("section",{id:"playback",children:[e("h2",{children:"Watch Now"}),e("div",{class:"server-selection",children:[e("button",{class:"server-btn active",onClick:s=>I(s.target.dataset.server),"data-server":"videasy",children:"Videasy"}),e("button",{class:"server-btn",onClick:s=>I(s.target.dataset.server),"data-server":"vidsrc",children:"VidSrc"}),e("button",{class:"server-btn",onClick:s=>I(s.target.dataset.server),"data-server":"embedsu",children:"Embeds.su"})]}),e("div",{class:"video-container",children:e("iframe",{id:"video-player",allowfullscreen:!0})}),c==="tv"&&e("div",{class:"select-container",children:[e("label",{for:"dub-select",children:"Audio:"}),e("select",{id:"dub-select",value:D,onChange:s=>{q(s.target.value==="true");const o=document.querySelector(".server-btn.active").dataset.server,h=u?.episodes?.[0]?.episode_number||1;I(o,u?.season_number,h,s.target.value==="true")},children:[e("option",{value:"false",children:"Subbed"}),e("option",{value:"true",children:"Dubbed"})]})]})]}),c==="tv"&&n.seasons&&e("section",{id:"seasons-episodes",children:[e("h2",{children:"Seasons & Episodes"}),e("div",{class:"seasons-container",children:n.seasons.filter(s=>s.season_number>0).map(s=>e("div",{class:`season-card ${u?.season_number===s.season_number?"active":""}`,onClick:()=>j(s.season_number),children:[e("img",{src:s.poster_path?`${B}${s.poster_path}`:"https://via.placeholder.com/130x200?text=No+Image",alt:s.name}),e("span",{children:s.name})]}))}),u&&(()=>{const s=u.episodes.length,o=Math.ceil(s/episodesPerPage),h=Math.ceil(o/pagesPerPagination),$=(G-1)*episodesPerPage,S=$+episodesPerPage,b=u.episodes.slice($,S),E=(k-1)*pagesPerPagination,w=E+pagesPerPagination,C=Array.from({length:o},(v,z)=>z+1).slice(E,w);return e("div",{children:[e("div",{class:"episodes-container",children:[e("h3",{children:u.name}),b.map(v=>e("div",{class:"episode-card",onClick:()=>I(document.querySelector(".server-btn.active").dataset.server,u.season_number,v.episode_number,D),children:[e("div",{class:"episode-thumbnail",children:e("img",{src:v.still_path?`${B}${v.still_path}`:"https://via.placeholder.com/150x84?text=No+Image",alt:v.name})}),e("div",{class:"episode-info",children:[e("h4",{children:[v.episode_number,". ",v.name]}),e("p",{children:v.overview})]})]}))]}),o>1&&e("div",{class:"pagination-controls",children:[k>1&&e("button",{onClick:()=>M(k-1),children:e("i",{class:"fas fa-angle-double-left"})}),C.map(v=>e("button",{class:G===v?"active":"",onClick:()=>H(v),children:v},v)),k<h&&e("button",{onClick:()=>M(k+1),children:e("i",{class:"fas fa-angle-double-right"})})]})]})})()]}),i.length>0&&e("section",{id:"recommendations",children:[e("h2",{children:"Recommendations"}),e("div",{class:"movie-grid",children:i.map(s=>e(te,{item:s,type:c}))})]})]}),V()]})};Q(e(ne,{}),document.getElementById("app"));
//# sourceMappingURL=movie-C8w9ienb.js.map
