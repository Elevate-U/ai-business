import{a as p,b as w,c as H,u as t,d as v}from"./index-1sUs75JS.js";import{d as a,q as W,y as _}from"./react-vendor-BYlzYzcd.js";import{H as d}from"./Helmet-DagAtqZQ.js";import{M as F}from"./MovieCard-DMDNfwWr.js";const L=()=>{const{user:e}=p(),[i,o]=a([]),[y,n]=a(!0),[l,h]=a(null),{removeContinueWatchingItem:u,fetchContinueWatching:f}=w(),s=W(async()=>{if(!e){n(!1);return}n(!0),h(null);try{const r=await H(e.id);o(r)}catch(r){console.error("Error fetching watch history:",r),h("Failed to load watch history. Please try again."),o([])}finally{n(!1)}},[e]);_(()=>{s()},[s,e]);const g=async r=>{o(i.filter(c=>c.watch_id!==r.watch_id)),u(r.media_id);try{await v(e.id,r),await f(e.id)}catch(c){console.error("Failed to delete item or refetch continue watching:",c)}},m=()=>{s()};return y?t("div",{class:"container",children:t("p",{children:"Loading watch history..."})}):l?t("div",{class:"container",children:[t(d,{children:t("title",{children:"Watch History - Fylm"})}),t("h1",{children:"Watch History"}),t("div",{class:"error-message",children:[t("p",{children:l}),t("button",{onClick:m,class:"retry-button",children:"Retry"})]})]}):t("div",{class:"container",children:[t(d,{children:t("title",{children:"Watch History - Fylm"})}),t("h1",{children:"Watch History"}),i.length>0?t("div",{class:"movie-grid",children:i.map(r=>t(F,{item:r,type:r.type,progress:r.progress_seconds,duration:r.duration_seconds,showDeleteButton:!0,onDelete:g},r.watch_id))}):t("p",{children:"Your watch history is empty."})]})};export{L as default};
//# sourceMappingURL=History-RC3myfaZ.js.map
